<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Data Retrieval with Importance Weights for Few-Shot Imitation Learning.">
  <meta name="keywords" content="Few-shot imitation learning, Retrieval, Data selection">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Data Retrieval with Importance Weights for Few-Shot Imitation Learning</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.ico">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>
<!-- 
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      
    </div>

  </div>
</nav> -->

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Data Retrieval with Importance Weights for Few-Shot Imitation Learning</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://amberxie88.github.io">Amber Xie</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="http://rahulschand.github.io">Rahul Chand</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://dorsa.fyi">Dorsa Sadigh</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://joeyhejna.com">Joey Hejna</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Stanford</span>
            <!-- <span class="author-block"><sup>2</sup>Google Research</span> -->
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <!-- <span class="link-block">
                <a href="TBD"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span> -->
              <span class="link-block">
                <a href="TBD"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. --> 
              <span class="link-block">
                <a href="TBD"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/jhejna/is-retrieval"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            While large-scale robot datasets have propelled recent progress in imitation learning, learning from smaller task specific datasets remains critical for deployment in new environments and unseen tasks. One such approach to few-shot imitation learning is retrieval-based imitation learning, which extracts relevant samples from large, widely available prior datasets to augment a limited demonstration dataset. To determine the relevant data from prior datasets, retrieval-based approaches most commonly calculate a prior data point's minimum distance to a point in the target dataset in latent space. While retrieval-based methods have shown success using this metric for data selection, we demonstrate its equivalence to the limit of a Gaussian kernel density (KDE) estimate of the target data distribution. This reveals two shortcomings of the retrieval rule used in prior work. First, it relies on high-variance nearest neighbor estimates that are susceptible to noise. Second, it does not account for the distribution of prior data when retrieving data. 
        </p>
        <p>
            To address these issues, we introduce <strong>Importance Weighted Retrieval (IWR)</strong>, which estimates importance weights, or the ratio between the target and prior data distributions for retrieval, using Gaussian KDEs. By considering the probability ratio, IWR overcomes the bias of previous selection rules, and by using reasonable modeling parameters, IWR effectively smooths estimates using all data points.  Across both simulation environments and real-world evaluations on the Bridge dataset we find that our method, IWR, consistently improves performance of existing retrieval-based methods, despite only requiring minor modifications.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <div class="publication-image">
            <figure>
              <img src="./static/images/main.png" alt="Method Figure" width="100%">
              <figcaption class="publication-caption">IWR consists of three main steps: (A) Learning a latent space to encode state-action pairs, (B) Estimating a probability distribution over the target and prior data, and using importance weights for data retrieval, and (C) Co-training on the target data and retrieved prior data. By augmenting our high-quality but much smaller target dataset with diverse, relevant prior samples, we learn more robust and performant policies.</figcaption>
            </figure>
          </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
    <div class="container is-max-desktop">
        
            <h2 class="title is-3 has-text-centered">Video Rollouts</h2>

            <div>
            <div class="content">
                <div id="hersheyskiss-video" class="video-container">
                  <h4 id="video-title" class="title is-6">Carrot (move carrot to dish rack)</h4>
                  <div class="video-wrapper">
                    <div class="video-item">
                      <video autoplay loop muted controls>
                        <source src="./static/videos/carrot_is.mp4" type="video/mp4">
                      </video>
                      <span class="video-caption">IWR (Ours)</span>
                    </div>
                    <div class="video-item">
                      <video autoplay loop muted controls>
                        <source src="static/videos/carrot_br.mp4" type="video/mp4">
                      </video>
                      <span class="video-caption">Behavior Retrieval</span>
                    </div>
                    <div class="video-item">
                      <video autoplay loop muted controls>
                        <source src="static/videos/carrot_bc.mp4" type="video/mp4">
                      </video>
                      <span class="video-caption">BC (no retrieval)</span>
                    </div>
                  </div>
                </div>
              </div>

              <h4 id="video-title" class="title is-6">Corn (move corn to plate)</h4>
              <div>
                <div class="content">
                    <div id="hersheyskiss-video" class="video-container">
                      <h4 id="video-title" class="title is-6"> </h4>
                      <div class="video-wrapper">
                        <div class="video-item">
                          <video autoplay loop muted controls>
                            <source src="./static/videos/corn_is.mp4" type="video/mp4">
                          </video>
                          <span class="video-caption">IWR (Ours)</span>
                        </div>
                        <div class="video-item">
                          <video autoplay loop muted controls>
                            <source src="static/videos/corn_br.mp4" type="video/mp4">
                          </video>
                          <span class="video-caption">Behavior Retrieval</span>
                        </div>
                        <div class="video-item">
                          <video autoplay loop muted controls>
                            <source src="static/videos/corn_bc.mp4" type="video/mp4">
                          </video>
                          <span class="video-caption">BC (no retrieval)</span>
                        </div>
                      </div>
                    </div>
                  </div>

                  
                    <div class="container is-max-desktop">
                      
                          <h4 class="title is-4 has-text-centered">Simulation: IWR (top) vs. BR (bottom)</h4>
                          <h4 class="title is-6">Soup-Sauce (put both the alphabet soup and the tomato sauce in the basket)</h4>

                          <div class="gif-wrapper">
                            <div class="method-label">IWR (Ours)</div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/is/ep_0.gif" alt="Soup Sauce 1">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/is/ep_1.gif" alt="Soup Sauce 2">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/is/ep_2.gif" alt="Soup Sauce 3">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/is/ep_3.gif" alt="Soup Sauce 4">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/is/ep_4.gif" alt="Soup Sauce 5">
                            </div>
                          </div>

                          <div class="gif-wrapper mb-2">
                            <div class="method-label">BR</div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/soup_sauce/br/ep_0.gif" alt="Soup Sauce 1">
                            </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/soup_sauce/br/ep_1.gif" alt="Soup Sauce 2">
                            </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/soup_sauce/br/ep_2.gif" alt="Soup Sauce 3">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/soup_sauce/br/ep_3.gif" alt="Soup Sauce 4">
                            </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/soup_sauce/br/ep_4.gif" alt="Soup Sauce 5">
                            </div>
                          </div>


                          <br><br> 
                          <h4 class="title is-6">Mug-Mug (put the white mug on the left plate and put the yellow and white mug on the right plate)</h4>
                          

                          <div class="gif-wrapper">
                            <div class="method-label">IWR (Ours)</div>
                            <div class="gif-item">
                              <img src="./static/gifs/mug_mug_looped/is/ep_2.gif" alt="Soup Sauce 1">
                            </div>
                            <div class="gif-item">
                              <img src="./static/gifs/mug_mug_looped/is/ep_5.gif" alt="Soup Sauce 2">
                            </div>
                            <div class="gif-item">
                                <img src="./static/gifs/mug_mug_looped/is/ep_7.gif" alt="Soup Sauce 4">
                              </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/mug_mug_looped/is/ep_6.gif" alt="Soup Sauce 3">
                            </div>
                            
                            <div class="gif-item">
                              <img src="./static/gifs/mug_mug_looped/is/ep_8.gif" alt="Soup Sauce 5">
                            </div>
                          </div>

                          <div class="gif-wrapper">
                            <div class="method-label">BR</div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/mug_mug_looped/br/ep_1.gif" alt="Soup Sauce 1">
                            </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/mug_mug_looped/br/ep_4.gif" alt="Soup Sauce 2">
                            </div>
                            <div class="gif-item">
                                <img src="./static/gifs/mug_mug_looped/br/ep_6.gif" alt="Soup Sauce 4">
                              </div>
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/mug_mug_looped/br/ep_5.gif" alt="Soup Sauce 3">
                            </div>
                            
                            <div class="gif-item-wrong">
                              <img src="./static/gifs/mug_mug_looped/br/ep_7.gif" alt="Soup Sauce 5">
                            </div>
                          </div>
                    </div>
        </div>
</section>
<div class="container is-max-desktop">
        
    <h2 class="title is-3 has-text-centered">Results</h2>

    <div class="publication-image">
        <figure>
          <img src="./static/images/main_results.png" alt="Method Figure" width="100%">
          
        </figure>
    </div>



<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{TBD,
  author    = {Xie, Amber and Chand, Rahul and Sadigh, Dorsa and Hejna, Joey},
  title     = {Data Retrieval with Importance Weights for Few-Shot Imitation Learning},
  journal   = {TBD},
  year      = {TBD},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
